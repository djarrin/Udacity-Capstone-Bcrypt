import{R as e,M as t,C as n,m as a,c as l,S as r,u as c,v as o,a as s,w as d,b as i,e as m,I as u,d as p,B as h,f as E,p as y,g,G as f,r as x}from"./vendor.c33d6772.js";function C(){return e.createElement(t,{fixed:"top",inverted:!0},e.createElement(n,null,e.createElement(t.Item,{header:!0},"Bcrypt Sandbox"),e.createElement(t.Item,null,"A tool for encrypting and decrypting text with bcrypt")))}function b(e){const t=new Uint8Array(e);return window.crypto.getRandomValues(t),t}const D=a((e=>{var t;e.select(),null==(t=e.setSelectionRange)||t.call(e,0,e.value.length),document.execCommand("copy")})),v=a((e=>i({password:e,costFactor:10,salt:b(16),outputType:"encoded"}))),k=l(),T=l(),w=l(),R=l(),H=l(),F=r(R,""),I=r(v.doneData,""),V=r(I.map((e=>e.length>0)).updates,!1).reset([T,F.updates]),A=c(!1).on(w,(()=>!0)).reset(I.updates),B=F.map((e=>0===e.length)),N=r(H,null);function S(){const t=m(I),n=m(V),a=m(A),l=m(B);return e.createElement(e.Fragment,null,e.createElement("h2",{className:"ui center aligned header"},e.createElement(u,{fitted:!0,name:"random"})," Encryption"),e.createElement(p,{type:"text",placeholder:"Enter some text to encrypt",onChange:(e,t)=>R(t.value),"data-test-id":"text-to-encrypt",fluid:!0,action:!0},e.createElement("input",null),e.createElement(h,{color:"blue",onClick:()=>k(),disabled:l,"data-test-id":"button-to-encrypt"},"Encrypt")),n&&e.createElement(E,{onDismiss:()=>T(),info:!0},e.createElement(E.Header,null,"Result:"),e.createElement(p,{action:e.createElement(h,{color:"teal",icon:!0,labelPosition:"right",onClick:()=>w()},a?"Copied!":"Copy"," ",e.createElement(u,{fitted:!0,name:"copy"})),value:t,ref:H,"data-test-id":"encrypted-text",fluid:!0})))}o({clock:k,source:F,target:v}),s({from:d({clock:w,source:N,filter:e=>null!==e}).map((e=>e.inputRef.current)),to:D});const j=a((e=>g(e))),G=l(),M=l(),P=l(),U=l(),W=r(P,""),$=r(U,""),q=r(j.doneData,!1),z=c(!1).on(G,(()=>!0)).reset([M,W.updates,$.updates]),J=$.map((e=>e.startsWith("$"))),K=y({textToDecrypt:W,hashToDecrypt:$,isHashToDecryptValid:J}).map((({textToDecrypt:e,hashToDecrypt:t,isHashToDecryptValid:n})=>0===e.length||0===t.length||!n));function L(){const t=m($),n=m(z),a=m(J),l=m(K),r=m(q);return e.createElement(e.Fragment,null,e.createElement("h2",{className:"ui center aligned header"},e.createElement(u,{fitted:!0,name:"retweet"})," Decryption"),e.createElement(p,{type:"text",error:t.length>0&&!a,placeholder:"Enter the hash to check",onChange:(e,t)=>U(t.value),"data-test-id":"hash-to-decrypt",fluid:!0}),e.createElement(p,{type:"text",placeholder:"Enter the text to check against",onChange:(e,t)=>P(t.value),"data-test-id":"text-to-decrypt",fluid:!0}),e.createElement(h,{color:"blue",onClick:()=>G(),disabled:l,"data-test-id":"button-to-decrypt",fluid:!0},"Check if hash and text match"),n&&r&&e.createElement(E,{header:"Result:",content:"Hash and text match!",onDismiss:()=>M(),"data-test-id":"decryption-result",success:!0}),n&&!r&&e.createElement(E,{header:"Result:",content:"Hash and text don't match.",onDismiss:()=>M(),negative:!0}))}function O(){return e.createElement(e.Fragment,null,e.createElement(C,null),e.createElement(n,{style:{marginTop:"7em"}},e.createElement(f,{stackable:!0,columns:2,divided:!0},e.createElement(f.Column,null,e.createElement(S,null)),e.createElement(f.Column,null,e.createElement(L,null)))))}o({clock:G,source:y({password:W,hash:$}),target:j}),x.exports.render(e.createElement(O,null),document.body.appendChild(document.createElement("div")));
